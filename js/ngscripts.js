function DEBUG(t,e){var n=new Date;n.toLocaleTimeString()}var app=angular.module("ccApp",["ui.bootstrap","ui.router","ngAnimate","infiniteScroll","ccAppViews"]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("error",{url:"/error",templateUrl:"components/error/error.html"})}]),viewsModule=angular.module("ccAppViews",["ui.router","templates","geolocation"]);app.controller("AppCtrl",["$scope","PageTitle","Loading",function(t,e,n){t.title=e,t.isCollapsed=!0,t.isLoading=n}]);var geonames=angular.module("geolocation",[]).constant("AUTH","&username=corkle").constant("API_PREFIX","http://api.geonames.org").constant("NEIGHBOURS_PATH","/neighboursJSON?country={{ code }}").constant("CAPITAL_PATH","/searchJSON?q={{ city }}&name_equals={{ city }}&featureCode=PPLC&country={{ code }}&isNameRequired=true").factory("geoRequest",["$http","$q","API_PREFIX","AUTH",function(t,e,n,o){return function(r){var i=e.defer();return t.get(n+r+o).success(function(t){i.resolve(t)}),i.promise}}]).factory("geoCountries",["$http","AUTH",function(t,e){return function(){return t({cache:!0,method:"GET",url:"http://api.geonames.org/countryInfoJSON?lang=en"+e})}}]).factory("geoCapital",["geoRequest","$interpolate","CAPITAL_PATH",function(t,e,n){return function(o,r){var i=e(n)({city:o,code:r});return t(i)}}]).factory("geoNeighbours",["geoRequest","$interpolate","NEIGHBOURS_PATH",function(t,e,n){return function(o){var r=e(n)({code:o});return t(r)}}]);app.factory("Loading",function(){var t=0,e=function(){return t>0};return{get:function(){return e()},set:function(e){e?t++:t--}}}),app.factory("PageTitle",function(){var t="Countries & Capitals";return{get:function(){return t},set:function(e){t=e}}}),viewsModule.config(["$stateProvider",function(t){t.state("countries",{url:"/countries",templateUrl:"components/countries/countries.html",controller:"CountriesCtrl as c"})}]).controller("CountriesCtrl",["getCountryData","$state","PageTitle",function(t,e,n){n.set("Browse Countries");var o=15;this.text="Text about country list";var r=this,i=[];t().then(function(t){i=t.sort(function(t,e){return t.countryName<e.countryName?-1:t.countryName>e.countryName?1:0}),r.countryList=i.slice(0,o)}),this.loadMore=function(){var t=r.countryList.length;r.countryList.push.apply(r.countryList,i.slice(t,t+o))},this.countryPage=function(t){e.go("country",{country:t.countryCode})}}]),viewsModule.factory("getCountryData",["geoCountries","$q","Loading",function(t,e,n){function o(t){for(var e={found:!1},n=0;n<r.length;n++)if(r[n].countryCode==t){e.found=!0,e.data=r[n];break}return e}var r=[];return function(i){n.set(!0);var u=e.defer();return t().then(function(t){r=t.data.geonames,i||u.resolve(r);var e=o(i);e.found?u.resolve(e.data):u.reject("Country Not Found.")}).then(function(){n.set(!1)}),u.promise}}]),viewsModule.config(["$stateProvider",function(t){t.state("country",{url:"/countries/{country}",templateUrl:"components/country/country.html",controller:"CountryCtrl as country",resolve:{country:["$state","$stateParams","$q","getCountryDetails",function(t,e,n,o){var r=n.defer(),i=e.country;return o(i).then(function(t){r.resolve(t)},function(e){t.go("error")}),r.promise}]}})}]).controller("CountryCtrl",["country","PageTitle",function(t,e){e.set(t.countryName),this.data=t,this.flagPath="http://www.geonames.org/flags/x/"+t.countryCode.toLowerCase()+".gif",this.mapPath="http://www.geonames.org/img/country/250/"+t.countryCode.toUpperCase()+".png"}]),viewsModule.factory("getCountryDetails",["$q","getCountryData","geoCapital","geoNeighbours","Loading",function(t,e,n,o,r){var i=function(e){var n=t.defer(),r={};return o(e).then(function(t){t.geonames&&t.totalResultsCount>0&&(r=t.geonames)})["finally"](function(){n.resolve(r)}),n.promise},u=function(e,o){if(e){var r,i=t.defer();return n(e,o).then(function(t){r=t.totalResultsCount>0?t.geonames[0].population:"DATA NOT FOUND",i.resolve(r)}),i.promise}};return function(n){r.set(!0);var o={},a=t.defer();return e(n).then(function(t){o=t}).then(function(){return t.all([i(n),u(o.capital,n)])}).then(function(t){o.neighbours=t[0],o.capitalPopulation=t[1]}).then(function(){r.set(!1),a.resolve(o)},function(t){r.set(!1),a.reject(t)}),a.promise}}]),viewsModule.config(["$stateProvider",function(t){t.state("home",{url:"/",templateUrl:"components/home/home.html",controller:"HomeCtrl as h"})}]),viewsModule.controller("HomeCtrl",["PageTitle",function(t){t.set("Countries & Capitals"),this.text="This is the home text."}]),angular.module("templates",[]).run(["$templateCache",function(t){t.put("components/countries/countries.html",'<h1>Countries</h1><p>{{ c.text }}</p><div class="scroll-list" infinite-scroll="c.loadMore()" can-load="true"><table class="table table-hover"><thead><tr><th>Country Name</th><th>Code</th><th>Capital</th><th>Area in km2</th><th>Population</th><th>Continent</th></tr></thead><tbody><tr ng-repeat="country in c.countryList track by country.countryCode" ng-click="c.countryPage(country)"><td ng-bind="::country.countryName"></td><td ng-bind="::country.countryCode"></td><td ng-bind="::country.capital"></td><td ng-bind="::country.areaInSqKm | number"></td><td ng-bind="::country.population | number"></td><td ng-bind="::country.continent"></td></tr></tbody></table></div><div class="inner"><a ui-sref="home"><button class="btn btn-lg btn-default">Home</button></a></div>'),t.put("components/country/country.html",'<div class="country-detail"><h1 ng-bind-template="{{::country.data.countryName}} ({{::country.data.countryCode}})"></h1><table class="table centered"><tr><th>Continent</th><td ng-bind="::country.data.continentName"></td></tr><tr><th>Population of Country</th><td ng-bind="::country.data.population | number"></td></tr><tr><th>Area</th><td ng-bind-template="{{::country.data.areaInSqKm | number}} km&#178"></td></tr><tr><th>Captial</th><td ng-bind="::country.data.capital"></td></tr><tr><th>Population of Capital</th><td ng-bind="::country.data.capitalPopulation | number"></td></tr><tr><th ng-bind-template="{{ ::country.data.neighbours.length }} Neighbours">Neighbors</th><td><span ng-repeat="neighbour in country.data.neighbours"><a ui-sref="country({country: neighbour.countryCode})">{{neighbour.countryName}}</a>{{ $last ? "" : ", "}}</span></td></tr></table><div class="row centered"><div class="col-sm-4 col-sm-offset-2 inner"><img id="country-flag" ng-src="{{country.flagPath}}"></div><div class="col-sm-4 inner"><img id="country-map" ng-src="{{country.mapPath}}"></div></div></div><div class="row inner"><a ui-sref="countries"><button type="button" class="btn btn-default">Countries</button></a> <a ui-sref="home"><button type="button" class="btn btn-default">Home</button></a></div>'),t.put("components/error/error.html","<p>Error - Page Not Found</p>"),t.put("components/home/home.html",'<h1>Countries and Capitals</h1><div class="inner"><p>{{ ::h.text }}</p><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nulla quas ea nihil inventore id unde quaerat eaque, est harum doloribus facilis molestias voluptas sint quisquam autem alias distinctio! Quis, culpa.</p><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem ipsa, corrupti cumque rem laborum sunt ipsum inventore et eligendi. Sit beatae id nobis harum deleniti unde dolores odit voluptatem ipsam.</p><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem ipsa, corrupti cumque rem laborum sunt ipsum inventore et eligendi. Sit beatae id nobis harum deleniti unde dolores odit voluptatem ipsam.</p><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem ipsa, corrupti cumque rem laborum sunt ipsum inventore et eligendi. Sit beatae id nobis harum deleniti unde dolores odit voluptatem ipsam.</p><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem ipsa, corrupti cumque rem laborum sunt ipsum inventore et eligendi. Sit beatae id nobis harum deleniti unde dolores odit voluptatem ipsam.</p></div><div class="inner"><a ui-sref="countries"><button class="btn btn-lg btn-default">Browse Countries</button></a></div>')}]);